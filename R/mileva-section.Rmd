---
output: html_document
editor_options: 
  chunk_output_type: console
---
# Birth Rate

Distribution of birth rates by continent
```{r birthrate, fig.cap="Distribution of Birth Rates by Continent", echo = FALSE}
ggplot2::ggplot(tidyr::drop_na(data.melt.avg), 
       ggplot2::aes(x = babies_per_woman_avg, y = forcats::fct_rev(as.factor(continent)), fill = ..x..)) +
  ggridges::geom_density_ridges_gradient(scale = 3, rel_min_height = 0.01) + 
  ggplot2::scale_fill_gradient2(low = "blue", high = "red") +
  ggplot2::xlab("Babies per woman") +
  ggplot2::ylab("") +
  ggplot2::ggtitle("Distribution of babies per woman") +
  ggplot2::theme_bw() +
  ggplot2::theme(plot.title = ggplot2::element_text(hjust = 0.5))
```

Scatter plots of birth rates by country
```{r birthrategini, fig.cap="Income Inequality to Birth Rate", echo = FALSE}
g <- ggplot2::ggplot(tidyr::drop_na(data.melt.avg), 
            ggplot2::aes(x = babies_per_woman_avg, y = gini_avg, col = continent,  size = income_avg)) + 
  ggplot2::geom_point(alpha = 0.7) + ggplot2::xlab("Babies per woman") + 
  ggplot2::ylab("Gini coefficient") +
  ggplot2::ggtitle("Gini coefficient vs. babies per woman") + 
  ggplot2::theme_bw() + 
  ggplot2::theme(plot.title = ggplot2::element_text(hjust = 0.5)) 

plotly::ggplotly(g)
```



# Quality of Life 

```{r lineplotsSubset, fig.cap = "Inequality to Quality of Life (subset)", echo = FALSE}
data <- data.melt.yearly %>% dplyr::filter(continent %in% c("Africa", "Asia", "Europe", "North America", "South America"))

require(gridExtra)
plot1 <- ggplot2::ggplot(tidyr::drop_na(data), ggplot2::aes(x=year, col = continent)) +
  ggplot2::geom_line(ggplot2::aes(y=suicide_avg)) + ggplot2::ylab("suicide rate") 
plot2 <- ggplot2::ggplot(tidyr::drop_na(data), ggplot2::aes(x=year, col = continent)) +
  ggplot2::geom_line(ggplot2::aes(y=babies_per_woman_avg)) + ggplot2::ylab("babies per woman") 
plot3 <- ggplot2::ggplot(tidyr::drop_na(data), ggplot2::aes(x=year, col = continent)) +
  ggplot2::geom_line(ggplot2::aes(y=education_discrepancy_avg)) + ggplot2::ylab("Education inequality") 
plot4 <- ggplot2::ggplot(tidyr::drop_na(data), ggplot2::aes(x=year, col = continent)) +
  ggplot2::geom_line(ggplot2::aes(y=gini_avg)) + ggplot2::ylab("Gini coefficient") 

ggpubr::ggarrange(plot1, plot2, plot3, plot4, ncol=4, nrow=1, common.legend = TRUE, legend="bottom")

# plot <- ggpubr::annotate_figure(plot, top = ggpubr::text_grob("Variables of interest over time",
#                color = "black", size = 14))

```

```{r lineplots, fig.cap = "Inequality to Quality of Life", echo = FALSE}
data <- data.melt.yearly %>% dplyr::filter(continent %in% c("Africa", "Europe", "Asia"))

require(gridExtra)
plot1 <- ggplot2::ggplot(tidyr::drop_na(data), ggplot2::aes(x=year, col = continent)) +
  ggplot2::geom_line(ggplot2::aes(y=suicide_avg)) + ggplot2::ylab("suicide rate") 
plot2 <- ggplot2::ggplot(tidyr::drop_na(data), ggplot2::aes(x=year, col = continent)) +
  ggplot2::geom_line(ggplot2::aes(y=babies_per_woman_avg)) + ggplot2::ylab("babies per woman") 
plot3 <- ggplot2::ggplot(tidyr::drop_na(data), ggplot2::aes(x=year, col = continent)) +
  ggplot2::geom_line(ggplot2::aes(y=education_discrepancy_avg)) + ggplot2::ylab("Education inequality") 
plot4 <- ggplot2::ggplot(tidyr::drop_na(data), ggplot2::aes(x=year, col = continent)) +
  ggplot2::geom_line(ggplot2::aes(y=gini_avg)) + ggplot2::ylab("Gini coefficient") 

ggpubr::ggarrange(plot1, plot2, plot3, plot4, ncol=4, nrow=1, common.legend = TRUE, legend="bottom")

# annotate_figure(plot_new, top = text_grob("Variables of interest over time",
#                color = "black", size = 14))
```
