# Quality of Life Associations
Up to now we have explored how each quality of life indicator is associated with income inequality. It is equally important to disect how the quality of life indicators interplay with eachother.

Figure \@ref(fig:violinplots) illustrates the distribution of each indicator by region. The colored-polygons represent the density for a given value. The box and whisker plot within each colored-polygon depicts the non-outlier quartile values. Note the different axes scales for each indicator.

```{r violinplots, fig.cap="Inequality to Quality of Life", echo=FALSE}
data.melt.comb <- data.melt %>% 
  dplyr::select(continent, gini, education_discrepancy, babies_per_woman, suicide) %>%
  reshape2::melt(id="continent")
  
plot.violin(data.melt.comb, highcharter::highchart(), "value", "continent", "variable", highcharter::data_to_boxplot(data.melt.comb, value, continent, variable), c(1, 0, 2, 3)) %>%
    highcharter::hc_yAxis_multiples(
      list(title = list(text = "Education Discrepancy"), maxRange=1),
      list(title = list(text = "Gini Coeficient")),
      list(title = list(text = "Babies"), opposite=T),
      list(title = list(text = "Suicide"), opposite=T))
```

```{r lineplotsSubset, fig.cap = "Quality of Life over Time", echo = FALSE}
data <- data.melt.yearly %>% dplyr::filter(continent %in% c("Africa", "Asia", "Europe", "North America", "South America"))

require(gridExtra)
plot1 <- ggplot2::ggplot(tidyr::drop_na(data), ggplot2::aes(x=year, col = continent)) +
  ggplot2::geom_line(ggplot2::aes(y=suicide_avg)) + ggplot2::ylab("suicide rate") 
plot2 <- ggplot2::ggplot(tidyr::drop_na(data), ggplot2::aes(x=year, col = continent)) +
  ggplot2::geom_line(ggplot2::aes(y=babies_per_woman_avg)) + ggplot2::ylab("babies per woman") 
plot3 <- ggplot2::ggplot(tidyr::drop_na(data), ggplot2::aes(x=year, col = continent)) +
  ggplot2::geom_line(ggplot2::aes(y=education_discrepancy_avg)) + ggplot2::ylab("Education inequality") 
plot4 <- ggplot2::ggplot(tidyr::drop_na(data), ggplot2::aes(x=year, col = continent)) +
  ggplot2::geom_line(ggplot2::aes(y=gini_avg)) + ggplot2::ylab("Gini coefficient") 

plot_new <- ggpubr::ggarrange(plot1, plot2, plot3, plot4, ncol=4, nrow=1, common.legend = TRUE, legend="bottom")

ggpubr::annotate_figure(plot_new, top = ggpubr::text_grob("Quality of Life over Time",
               color = "black", size = 14))

```
```{r}
fig<-data.melt.avg %>% dplyr::mutate_if(is.numeric, round, 2)%>%
  plotly::plot_ly(
             x=~education_discrepancy_avg,y=~babies_per_woman_avg,z=~suicide_avg,
             color=~continent,colors=region.color,alpha=.8,
             text=~country,
             hovertemplate=paste('%{x}','%{text}','GINI:%{y}','SR:%{z}',sep='<br>'))
fig <- fig %>% plotly::add_markers()
fig <- fig %>% plotly::layout(scene = list(xaxis = list(title = 'Education Discrepancy'),
                     yaxis = list(title = 'Babies per Woman'),
                     zaxis = list(title = 'Suicide Rate')))
fig <- fig %>% plotly::layout(title="Suicide Rate by GINI Index", showlegend = T)
fig
```

