# Quality of Life Associations
Up to now we have explored how each quality of life indicator is associated with income inequality. It is equally important to disect how the quality of life indicators interplay with eachother.

Figure \@ref(fig:violinplots) illustrates the distribution of each indicator by region. The colored-polygons represent the density for a given value. The box and whisker plot within each colored-polygon depicts the non-outlier quartile values. Note the different axes scales for each indicator.

```{r violinplots, fig.cap="Inequality to Quality of Life", echo=FALSE}
data.melt.comb <- data.melt %>% 
  dplyr::select(continent, gini, education_discrepancy, babies_per_woman, suicide) %>%
  reshape2::melt(id="continent")
  
plot.violin(data.melt.comb, highcharter::highchart(), "value", "continent", "variable", highcharter::data_to_boxplot(data.melt.comb, value, continent, variable), c(1, 0, 2, 3)) %>%
    highcharter::hc_yAxis_multiples(
      list(title = list(text = "Education Discrepancy"), maxRange=1),
      list(title = list(text = "Gini Coeficient")),
      list(title = list(text = "Babies"), opposite=T),
      list(title = list(text = "Suicide"), opposite=T))
```

```{r lineplotsSubset, fig.cap = "Quality of Life over Time", echo = FALSE}
data <- data.melt.yearly %>% dplyr::filter(continent %in% c("Africa", "Asia", "Europe", "North America", "South America"))

require(gridExtra)
plot1 <- ggplot2::ggplot(tidyr::drop_na(data), ggplot2::aes(x=year, col = continent)) +
  ggplot2::geom_line(ggplot2::aes(y=suicide_avg)) + ggplot2::ylab("suicide rate") 
plot2 <- ggplot2::ggplot(tidyr::drop_na(data), ggplot2::aes(x=year, col = continent)) +
  ggplot2::geom_line(ggplot2::aes(y=babies_per_woman_avg)) + ggplot2::ylab("babies per woman") 
plot3 <- ggplot2::ggplot(tidyr::drop_na(data), ggplot2::aes(x=year, col = continent)) +
  ggplot2::geom_line(ggplot2::aes(y=education_discrepancy_avg)) + ggplot2::ylab("Education inequality") 
plot4 <- ggplot2::ggplot(tidyr::drop_na(data), ggplot2::aes(x=year, col = continent)) +
  ggplot2::geom_line(ggplot2::aes(y=gini_avg)) + ggplot2::ylab("Gini coefficient") 

plot_new <- ggpubr::ggarrange(plot1, plot2, plot3, plot4, ncol=4, nrow=1, common.legend = TRUE, legend="bottom")

ggpubr::annotate_figure(plot_new, top = ggpubr::text_grob("Quality of Life over Time",
               color = "black", size = 14))

```

```{r variableComparison, fig.cap = "Individual Variables by GINI Index", echo = FALSE}
#Sets variables used, category names, and scaling.
data.cat<-cbind(data.melt.avg$country,data.melt.avg$gini_avg,data.melt.avg$poverty_avg,'Poverty')
data.cat<-rbind(data.cat,
                cbind(data.melt.avg$country,data.melt.avg$gini_avg,(data.melt.avg$education_avg*.66),'Education (2/3)'))
data.cat<-rbind(data.cat,
                cbind(data.melt.avg$country,data.melt.avg$gini_avg,(data.melt.avg$suicide_avg*2),'Suicides per 100,00 (x2)'))
data.cat<-rbind(data.cat,
                cbind(data.melt.avg$country,data.melt.avg$gini_avg,(data.melt.avg$babies_per_woman_avg*10),'Average Babies per Woman (x10)'))

colnames(data.cat)<-c('country','gini','values','type')
data.cat<-data.frame(data.cat)
data.cat$gini<-as.numeric(data.cat$gini)
data.cat$values<-as.numeric(data.cat$values)


plot<-ggplot2::ggplot(data=data.cat) +
  ggplot2::geom_point(mapping=aes_string(
    x='gini',
    y='values',
    alpha = .3
  )) +
  ggplot2::ggtitle(paste('Individual Variables by GINI Index',sep='')) +
  ggplot2::xlab('GINI Index') + xlim(25,75) +
  ggplot2::ylab('Adjusted Values') + ylim(0,100) +
  ggplot2::guides(size="none",alpha="none") +
  ggplot2::scale_color_manual(values = region.color,na.translate=FALSE) +
  ggplot2::theme_minimal()

plot + ggplot2::facet_wrap(~type,nrow=2,ncol=2)
```