---
output: html_document
editor_options: 
  chunk_output_type: console
---
# Education

```{r educationgini, fig.cap="Income Inequality to Education Inequality", echo=FALSE}
highcharter::hchart(data.melt.avg, "point",
          highcharter::hcaes(education_discrepancy_avg, gini_avg, z=income_avg, group = continent)) %>% 
  highcharter::hc_colors(region.color)%>% 
  highcharter::hc_plotOptions(bubble=list(minSize="1%",maxSize="10%")) %>% highcharter::hc_tooltip(
      pointFormat = "<b>{point.country}</b>
          <br/>{series.xAxis.axisTitle.textStr}: {point.x}
          <br/>{series.yAxis.axisTitle.textStr}: {point.y}
          <br/>{series.yAxis.axisTitle.textStr}: {point.y}
          <br/>Boys: {point.education_boys_avg}
          <br/>Girls: {point.education_girls_avg}
          <br/>Income: {point.z}") %>%
  hc.label("Education Discrepancy", "Gini Coefficient")
```

# Quality of Life

```{r}
highcharter::highchart()%>%
  highcharter::hc_yAxis_multiples(list(title = list(text = "Education Discrepancy", colorIndex=1)),list(title = list(text = "Gini Coeficient")),list(title = list(text = "Suicide"), opposite=T),list(title = list(text = "Babies"), opposite=T))%>%
  highcharter::hc_add_series_list(highcharter::data_to_boxplot(data.melt, gini, continent, name="Gini Coefficient", yAxis=1)) %>%
  highcharter::hc_add_series_list(highcharter::data_to_boxplot(data.melt, education_discrepancy, continent, name="Education Discrepancy", yAxis=0)) %>%
  highcharter::hc_add_series_list(highcharter::data_to_boxplot(data.melt, suicide, continent, name="Suicide", yAxis=2)) %>%
  highcharter::hc_add_series_list(highcharter::data_to_boxplot(data.melt, babies_per_woman, continent, name="Babies", yAxis=3)) 
```


```{r violinplots, fig.cap="Inequality to Quality of Life", echo=FALSE}
data.melt.comb <- data.melt %>% 
  dplyr::select(continent, gini, education_discrepancy, babies_per_woman, suicide) %>%
  reshape2::melt(id="continent")
  
plot.violin(data.melt.comb, highcharter::highchart(), "value", "continent", "variable", highcharter::data_to_boxplot(data.melt.comb, value, continent, variable)) %>%
    highcharter::hc_yAxis_multiples(
      list(title = list(text = "Education Discrepancy")),
      list(title = list(text = "Gini Coeficient")),
      list(title = list(text = "Suicide"), opposite=T),
      list(title = list(text = "Babies"), opposite=T))
```
